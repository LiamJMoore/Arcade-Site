<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Scanner | RoastMe.fun</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link rel="icon" href="12.png" type="image/png">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=Press+Start+2P&family=Kalam:wght@700&display=swap');
        :root { --roast-bg: #050201; --roast-orange: #f97316; --roast-card: #1c100b; }
        body { font-family: 'Inter', sans-serif; background-color: var(--roast-bg); color: white; overflow-x: hidden; }
        .font-pixel { font-family: 'Press Start 2P', cursive; }
        .roast-card { background-color: var(--roast-card); border: 2px solid rgba(249, 115, 22, 0.1); transition: all 0.2s; position: relative; overflow: hidden; }
        .roast-card:hover { border-color: var(--roast-orange); transform: translateY(-2px); box-shadow: 0 0 20px rgba(249, 115, 22, 0.2); }
        .card-variant { display: none !important; }
        .card-variant.active { display: block !important; animation: popIn 0.3s ease; }
        @keyframes popIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        /* Include all your detailed card CSS here if needed, keeping it light for this specific file */
        .report-paper { background: #0d1117; width: 350px; border-radius: 20px; overflow: hidden; border: 2px solid #333; position: relative; }
        .report-header { background: #161b22; padding: 20px; border-bottom: 2px solid var(--roast-orange); }
        .report-stamp { position: absolute; top: 10px; right: 10px; font-size: 2.5rem; font-weight: 900; color: #ef4444; border: 4px solid #ef4444; padding: 5px; transform: rotate(-12deg); opacity: 0.8; font-family: 'Press Start 2P'; z-index: 50; background: rgba(0,0,0,0.5); }
        #results-section { display: none; } /* Hidden by default */
        .wrapped-card { aspect-ratio: 1/1; border-radius: 24px; padding: 20px; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; position: relative; overflow: hidden; box-shadow: 0 10px 25px rgba(0,0,0,0.3); }
        .theme-dark { background: #1a1a1a; border: 2px solid #333; color: white; }
    </style>
</head>
<body class="min-h-screen pt-4 pb-20">
    <nav class="flex justify-between items-center px-6 mb-8">
        <a href="index.html" class="flex items-center gap-2 text-gray-400 hover:text-white transition-colors text-xs font-bold font-mono">
            <i data-lucide="arrow-left" width="14"></i> ARCADE LOBBY
        </a>
        <div class="text-[var(--roast-orange)] font-pixel text-xs">ROASTME<span class="text-white">.FUN</span></div>
    </nav>

    <div id="input-section" class="container mx-auto px-4 max-w-lg text-center mt-20">
        <img src="12.png" class="w-24 h-24 mx-auto mb-6 drop-shadow-[0_0_20px_rgba(249,115,22,0.5)]">
        <h1 class="text-2xl md:text-3xl font-pixel mb-6 leading-tight text-white">
            WALLET <span class="text-[var(--roast-orange)]">SCANNER</span>
        </h1>
        <div class="bg-[#1c100b] p-2 rounded-xl flex flex-col items-center border border-[var(--roast-orange)]/30 shadow-2xl">
            <input type="text" id="wallet-input" placeholder="Paste Solana Address..." class="bg-transparent text-white px-4 py-3 w-full focus:outline-none font-mono text-xs text-center placeholder-gray-600">
            <button onclick="fetchRealStats()" class="w-full bg-[var(--roast-orange)] text-black font-pixel text-[10px] px-6 py-4 rounded mt-2 hover:bg-white transition-colors">
                SCAN NOW
            </button>
        </div>
        <div id="loading-ui" class="hidden mt-4 text-[10px] font-mono text-[var(--roast-orange)] animate-pulse">READING CHAIN DATA...</div>
    </div>

    <div id="results-section" class="container mx-auto max-w-4xl px-4 mt-10">
        <div class="flex flex-col md:flex-row gap-6">
            <div class="flex-1 space-y-4">
                <div class="roast-card p-6 rounded-xl border-l-4 border-[var(--roast-orange)]">
                    <div class="text-[10px] text-gray-500 font-mono">GRADE</div>
                    <div id="grade-display" class="text-6xl font-pixel text-[var(--roast-orange)]">?</div>
                    <div id="risk-val" class="text-xs font-bold text-red-500 mt-2">CALCULATING RISK...</div>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div class="roast-card p-4 rounded-xl">
                        <div class="text-[10px] text-gray-500">NET WORTH</div>
                        <div id="real-balance" class="text-lg font-bold">0.00 SOL</div>
                    </div>
                    <div class="roast-card p-4 rounded-xl">
                        <div class="text-[10px] text-gray-500">BAGS</div>
                        <div id="real-token-count" class="text-lg font-bold">0</div>
                    </div>
                </div>
                <div class="flex gap-2">
                    <button id="view-report-btn" onclick="openModal()" class="flex-1 bg-[var(--roast-orange)] text-black font-bold py-3 rounded-lg text-xs flex justify-center gap-2 items-center hover:bg-white">
                        <i data-lucide="eye" width="14"></i> SEE CARD
                    </button>
                    <button onclick="location.reload()" class="bg-white/10 text-white p-3 rounded-lg hover:bg-white/20"><i data-lucide="refresh-cw" width="14"></i></button>
                </div>
            </div>
            
            <div class="md:w-64">
                <div class="roast-card p-4 rounded-xl h-64 overflow-hidden relative">
                    <div class="text-[10px] text-[var(--roast-orange)] font-mono mb-2 border-b border-white/10 pb-2">LIVE VICTIMS</div>
                    <div id="live-feed" class="text-[10px] font-mono text-gray-400 space-y-2"></div>
                </div>
            </div>
        </div>

        <div class="mt-12">
            <h3 class="font-pixel text-lg mb-6 text-center text-white">REALITY CHECK</h3>
            <div id="roast-grid" class="grid grid-cols-2 md:grid-cols-4 gap-4"></div>
        </div>
    </div>

    <div id="report-card-modal" class="fixed inset-0 bg-black/90 z-50 hidden items-center justify-center p-4" onclick="this.style.display='none'">
        <div id="capture-target" class="report-paper" onclick="event.stopPropagation()">
            <div class="report-header">
                <div class="flex items-center gap-2">
                    <img src="12.png" class="w-8 h-8 rounded-full border border-white/20">
                    <div>
                        <div class="font-pixel text-[10px] text-[var(--roast-orange)]">ROASTME.FUN</div>
                        <div class="text-[8px] text-gray-400 font-mono">OFFICIAL REPORT</div>
                    </div>
                </div>
                <div id="card-stamp" class="report-stamp">F</div>
            </div>
            <div class="p-6">
                <div class="flex gap-4 mb-4">
                    <div class="w-1/2 bg-[#1a2332] rounded p-2 border border-white/5 flex items-center justify-center">
                         <div class="text-[10px] text-gray-500 text-center">PSYCH PROFILE<br>[Visualizing...]</div>
                    </div>
                    <div class="w-1/2 space-y-2">
                        <div><div class="text-[8px] text-gray-500">ARCHETYPE</div><div id="card-archetype" class="text-xs font-bold text-white">LOADING...</div></div>
                        <div><div class="text-[8px] text-gray-500">IQ</div><div class="h-1 bg-gray-700 rounded"><div id="stat-iq-bar" class="h-full bg-[var(--roast-orange)]" style="width: 20%"></div></div></div>
                    </div>
                </div>
                <div class="bg-[#1a2332] p-3 rounded border border-white/5 mb-2">
                    <div class="text-[8px] text-[var(--roast-orange)] font-bold mb-1">CHEF'S COMMENT</div>
                    <p id="card-comment" class="font-hand text-xs text-gray-300 italic">...</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();
        const HELIUS_API_KEY = "f7d6a830-5ce4-436e-bd8d-73f75b0f0c52";
        const RPC_ENDPOINT = `https://mainnet.helius-rpc.com/?api-key=${HELIUS_API_KEY}`;
        let connection = new solanaWeb3.Connection(RPC_ENDPOINT, 'confirmed');
        
        // Mock Data
        const ARCHETYPES = { JEET: { name: "THE JEET", grade: "F-", risk: "CRITICAL" }, WHALE: { name: "THE WHALE", grade: "A+", risk: "LOW" }, NPC: { name: "THE NPC", grade: "C", risk: "HIGH" } };
        const BAD_ROASTS = ["McDonald's is hiring.", "Rugged by a 12yo?", "Exit Liquidity Provider", "Still Broke?"];

        // Live Feed
        function startLiveFeed() {
            const feed = document.getElementById('live-feed');
            setInterval(() => {
                const item = document.createElement('div');
                item.innerText = `Wallet ${Math.floor(Math.random()*99)}x... REKT (-99%)`;
                feed.prepend(item);
                if(feed.children.length > 5) feed.lastChild.remove();
            }, 1500);
        }
        startLiveFeed();

        async function fetchRealStats() {
            const wallet = document.getElementById('wallet-input').value;
            if(wallet.length < 10) return alert("Paste a real wallet address.");
            
            document.getElementById('loading-ui').classList.remove('hidden');
            
            // SIMULATED FETCH FOR SPEED/DEMO (Replace with real logic if desired)
            setTimeout(() => {
                processLogic(wallet, Math.random() * 10, 50);
            }, 1500);
        }

        function processLogic(wallet, balance, count) {
            document.getElementById('input-section').style.display = 'none';
            const res = document.getElementById('results-section');
            res.style.display = 'block'; // Force block
            
            // Logic
            const type = balance > 5 ? ARCHETYPES.WHALE : ARCHETYPES.JEET;
            
            // Update UI
            document.getElementById('grade-display').innerText = type.grade;
            document.getElementById('risk-val').innerText = type.risk;
            document.getElementById('real-balance').innerText = balance.toFixed(2) + " SOL";
            document.getElementById('real-token-count').innerText = count;
            
            // Update Card
            document.getElementById('card-stamp').innerText = type.grade;
            document.getElementById('card-archetype').innerText = type.name;
            document.getElementById('card-comment').innerText = "\"You tried. You failed. Try again.\"";
            
            generateRoastCards();
            confetti();
        }

        function generateRoastCards() {
            const grid = document.getElementById('roast-grid');
            grid.innerHTML = '';
            BAD_ROASTS.forEach(roast => {
                const el = document.createElement('div');
                el.className = 'wrapped-card theme-dark p-4 rounded text-[10px] flex items-center justify-center text-center h-24 border border-white/10';
                el.innerText = roast;
                grid.appendChild(el);
            });
        }

        function openModal() { document.getElementById('report-card-modal').style.display = 'flex'; }
    </script>
</body>
</html>
