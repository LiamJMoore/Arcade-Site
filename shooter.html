<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Paper Hands Shooter | RoastMe.fun</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        body { background: #050201; color: white; font-family: 'Press Start 2P', cursive; overflow: hidden; touch-action: none; }
        
        #game-container { 
            position: relative; width: 100vw; height: 100vh; 
            display: flex; justify-content: center; align-items: center; 
        }
        
        canvas { 
            background: #0f0502; 
            border-left: 2px solid #f97316; 
            border-right: 2px solid #f97316; 
            box-shadow: 0 0 30px rgba(249, 115, 22, 0.2); 
            width: 100%; height: 100%; max-width: 600px;
        }

        .ui { position: absolute; top: 20px; left: 20px; color: #f97316; z-index: 10; font-size: 14px; }
        
        /* IMPROVED GAME OVER SCREEN */
        #game-over { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); 
            display: none; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            z-index: 50; 
        }
        
        .btn { 
            background: #f97316; color: black; border: none; 
            padding: 20px 40px; font-family: inherit; font-size: 16px; 
            margin-top: 20px; cursor: pointer; border-radius: 8px;
            transition: transform 0.1s;
        }
        .btn:active { transform: scale(0.95); }
        
        .btn-exit {
            background: transparent; color: #666; border: 2px solid #333;
            margin-top: 15px; font-size: 12px; padding: 15px 30px;
        }
        .btn-exit:hover { color: white; border-color: white; }

        /* Touch Controls */
        .touch-zone { position: absolute; bottom: 0; height: 50%; width: 33%; z-index: 20; opacity: 0; }
        #left-zone { left: 0; } #right-zone { right: 0; } #fire-zone { left: 33%; width: 34%; }
    </style>
</head>
<body>
    <div class="ui">SCORE: <span id="score">0</span></div>
    
    <div id="game-container">
        <canvas id="canvas"></canvas>
        
        <div id="game-over">
            <h1 class="text-red-500 text-3xl mb-4 text-center">MARKET CRASHED</h1>
            <p class="text-xs text-gray-400 mb-8 text-center max-w-xs leading-6">
                The Jeets dumped on you.<br>Portfolio: -99%
            </p>
            
            <button class="btn" onclick="location.reload()">BUY THE DIP (REPLAY)</button>
            
            <button class="btn btn-exit" onclick="window.location.href='index.html'">EXIT TO LOBBY</button>
        </div>

        <div id="left-zone" class="touch-zone"></div>
        <div id="fire-zone" class="touch-zone"></div>
        <div id="right-zone" class="touch-zone"></div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        
        // Resize logic to ensure full screen on mobile but capped width on desktop
        function resize() {
            canvas.width = window.innerWidth > 600 ? 600 : window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        // Game State
        let score = 0;
        let gameOver = false;
        let frame = 0;

        // Entities
        const player = { x: canvas.width/2 - 20, y: canvas.height - 100, w: 40, h: 40, speed: 7, dx: 0, icon: "üêÇ" };
        let bullets = [];
        let enemies = [];

        // Controls
        window.addEventListener('keydown', e => {
            if(e.code === 'ArrowLeft') player.dx = -player.speed;
            if(e.code === 'ArrowRight') player.dx = player.speed;
            if(e.code === 'Space') shoot();
        });
        window.addEventListener('keyup', e => {
            if(e.code === 'ArrowLeft' || e.code === 'ArrowRight') player.dx = 0;
        });

        // Mobile
        document.getElementById('left-zone').ontouchstart = (e) => { e.preventDefault(); player.dx = -player.speed; };
        document.getElementById('left-zone').ontouchend = (e) => { e.preventDefault(); player.dx = 0; };
        
        document.getElementById('right-zone').ontouchstart = (e) => { e.preventDefault(); player.dx = player.speed; };
        document.getElementById('right-zone').ontouchend = (e) => { e.preventDefault(); player.dx = 0; };
        
        document.getElementById('fire-zone').ontouchstart = (e) => { e.preventDefault(); shoot(); };

        function shoot() {
            if(gameOver) return;
            bullets.push({ x: player.x + 15, y: player.y, w: 10, h: 20, speed: 12 });
        }

        function spawnEnemy() {
            const types = ["üß¢", "ü§°", "üìâ", "üêª"]; 
            const x = Math.random() * (canvas.width - 40);
            enemies.push({ 
                x: x, y: -40, w: 40, h: 40, 
                speed: 3 + (score/500), 
                type: types[Math.floor(Math.random()*types.length)] 
            });
        }

        function update() {
            if(gameOver) return;
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Player
            player.x += player.dx;
            if(player.x < 0) player.x = 0;
            if(player.x > canvas.width - 40) player.x = canvas.width - 40;
            ctx.font = "40px Arial";
            ctx.fillText(player.icon, player.x, player.y + 35);

            // Bullets (Green Candles)
            bullets.forEach((b, i) => {
                b.y -= b.speed;
                ctx.fillStyle = "#22c55e";
                ctx.fillRect(b.x, b.y, b.w, b.h);
                // Wick
                ctx.fillStyle = "white";
                ctx.fillRect(b.x + 4, b.y - 4, 2, 4);
                if(b.y < 0) bullets.splice(i, 1);
            });

            // Enemies
            if(frame % 50 === 0) spawnEnemy();
            
            enemies.forEach((e, i) => {
                e.y += e.speed;
                ctx.font = "35px Arial";
                ctx.fillText(e.type, e.x, e.y + 35);

                // Collision Player (Game Over)
                if(e.y + e.h > player.y + 10 && e.x < player.x + player.w && e.x + e.w > player.x) {
                    endGame();
                }
                
                // Collision Bullet (Kill Enemy)
                bullets.forEach((b, bi) => {
                    if(b.x < e.x + e.w && b.x + b.w > e.x && b.y < e.y + e.h && b.y + b.h > e.y) {
                        enemies.splice(i, 1);
                        bullets.splice(bi, 1);
                        score += 100;
                        document.getElementById('score').innerText = score;
                    }
                });

                if(e.y > canvas.height) endGame(); // Missed one = Market Crash
            });

            frame++;
            requestAnimationFrame(update);
        }

        function endGame() {
            gameOver = true;
            document.getElementById('game-over').style.display = 'flex'; // Using flex to center content
        }

        update();
    </script>
</body>
</html>
